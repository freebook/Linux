<chapter id="index"><?dbhtml dir="gpg" ?>
	<title>GnuPG</title>
	<section>
		<title>å®‰è£… GnuPG</title>
		<para>
			<ulink url="http://www.gnupg.org" />
		</para>
		<screen>
		<![CDATA[
[root@netkiller ~]# dnf install -y gnupg
		]]>
		</screen>
	</section>
	<section id="gpg.gen-key">
		<title>åˆ›å»ºå¯†é’¥</title>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --gen-key
gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Note: Use "gpg --full-generate-key" for a full featured key generation dialog.

GnuPG needs to construct a user ID to identify your key.

Real name: Neo Chen
Email address: netkiller@msn.com
You selected this USER-ID:
    "Neo Chen <netkiller@msn.com>"

Change (N)ame, (E)mail, or (O)kay/(Q)uit? O
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: /root/.gnupg/trustdb.gpg: trustdb created
gpg: key F01C0CAEAAA458E6 marked as ultimately trusted
gpg: directory '/root/.gnupg/openpgp-revocs.d' created
gpg: revocation certificate stored as '/root/.gnupg/openpgp-revocs.d/70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6.rev'
public and secret key created and signed.

pub   rsa2048 2021-10-08 [SC] [expires: 2023-10-08]
      70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6
uid                      Neo Chen <netkiller@msn.com>
sub   rsa2048 2021-10-08 [E] [expires: 2023-10-08]		
		]]>
		</screen>
		<para></para>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --full-generate-key
gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
  (14) Existing key from card
Your selection? 
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (2048) 
Requested keysize is 2048 bits
Please specify how long the key should be valid.
         0 = key does not expire
      <n>  = key expires in n days
      <n>w = key expires in n weeks
      <n>m = key expires in n months
      <n>y = key expires in n years
Key is valid for? (0) 
Key does not expire at all
Is this correct? (y/N) y

GnuPG needs to construct a user ID to identify your key.

Real name: Netkiller
Email address: netkiller@msn.com
Comment: Test Key
You selected this USER-ID:
    "Netkiller (Test Key) <netkiller@msn.com>"

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: key 5E27578A03F0B510 marked as ultimately trusted
gpg: revocation certificate stored as '/root/.gnupg/openpgp-revocs.d/E1C21F034FC0ACBF1337EE905E27578A03F0B510.rev'
public and secret key created and signed.

pub   rsa2048 2021-10-08 [SC]
      E1C21F034FC0ACBF1337EE905E27578A03F0B510
uid                      Netkiller (Test Key) <netkiller@msn.com>
sub   rsa2048 2021-10-08 [E]
		]]>
		</screen>
	</section>
	<section id="gpg.list-keys">
		<title>æŸ¥çœ‹å¯†é’¥</title>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --list-keys
gpg: checking the trustdb
gpg: marginals needed: 3  completes needed: 1  trust model: pgp
gpg: depth: 0  valid:   2  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 2u
gpg: next trustdb check due at 2023-10-08
/root/.gnupg/pubring.kbx
------------------------
pub   rsa2048 2021-10-08 [SC] [expires: 2023-10-08]
      70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6
uid           [ultimate] Neo Chen <netkiller@msn.com>
sub   rsa2048 2021-10-08 [E] [expires: 2023-10-08]

pub   rsa2048 2021-10-08 [SC]
      E1C21F034FC0ACBF1337EE905E27578A03F0B510
uid           [ultimate] Netkiller (Test Key) <netkiller@msn.com>
sub   rsa2048 2021-10-08 [E]		
		]]>
		</screen>
		<para>æŸ¥çœ‹ç§é’¥</para>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --list-secret-keys
/root/.gnupg/pubring.kbx
------------------------
sec   rsa2048 2021-10-08 [SC] [expires: 2023-10-08]
      70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6
uid           [ultimate] Neo Chen <netkiller@msn.com>
ssb   rsa2048 2021-10-08 [E] [expires: 2023-10-08]		
		]]>
		</screen>
		<para>SCï¼ˆ"sign","certify"ï¼Œä»£è¡¨å¯ä»¥ç­¾åå’Œè®¤è¯å…¶å®ƒå¯†é’¥ï¼‰</para>
		<para>Eï¼ˆ"encrypt"ï¼ŒåŠ å¯†ï¼‰</para>
		<para>Sï¼ˆ"sign"ï¼Œç­¾åï¼‰</para>
		<screen>
		<![CDATA[
sec => 'SECret key'
ssb => 'Secret SuBkey'
pub => 'PUBlic key'
sub => 'public SUBkey'		
		]]>
		</screen>
		<para>æ ¼å¼åŒ–</para>
		<screen>
		<![CDATA[
[root@gitlab ~]# gpg --list-secret-keys --keyid-format LONG
/root/.gnupg/pubring.kbx
------------------------
sec   rsa2048/F01C0CAEAAA458E6 2021-10-08 [SC] [expires: 2023-10-08]
      70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6
uid                 [ultimate] Neo Chen <netkiller@msn.com>
ssb   rsa2048/EAA2F7FD813D2A2E 2021-10-08 [E] [expires: 2023-10-08]

sec   rsa2048/4113D1268C351687 2021-10-09 [SC] [expires: 2023-10-09]
      DBF998A60B206C9297ABC57A4113D1268C351687
uid                 [ultimate] Tests <test@test.com>
ssb   rsa2048/EA6FAF428416D577 2021-10-09 [E] [expires: 2023-10-09]

sec   rsa2048/0C835D03507C8536 2021-10-09 [SC] [expires: 2023-10-09]
      18235CBA04497C42EFAC78210C835D03507C8536
uid                 [ultimate] Backup <backup@netkiller.cn>
ssb   rsa2048/339634D92F842BE7 2021-10-09 [E] [expires: 2023-10-09]	
		]]>
		</screen>
	</section>
	<section id="gpg.gen-revoke">
		<title>åŠé”€å¯†é’¥</title>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --gen-revoke E1C21F034FC0ACBF1337EE905E27578A03F0B510

sec  rsa2048/5E27578A03F0B510 2021-10-08 Netkiller (Test Key) <netkiller@msn.com>

Create a revocation certificate for this key? (y/N) y
Please select the reason for the revocation:
  0 = No reason specified
  1 = Key has been compromised
  2 = Key is superseded
  3 = Key is no longer used
  Q = Cancel
(Probably you want to select 1 here)
Your decision? 0
Enter an optional description; end it with an empty line:
> revoke key
> 
Reason for revocation: No reason specified
revoke key
Is this okay? (y/N) y
ASCII armored output forced.
-----BEGIN PGP PUBLIC KEY BLOCK-----
Comment: This is a revocation certificate

iQFABCABCAAqFiEE4cIfA0/ArL8TN+6QXidXigPwtRAFAmFgHfAMHQByZXZva2Ug
a2V5AAoJEF4nV4oD8LUQHTQH/iZdX2mAq2jOT/QwvKxMT6ePLJb1yQ+2aFUkvV2m
tgGfWh7k94rKpukXBk3Ay9HgOQRx450SFqo7dA9sGZFoVGxAd8iC2c0ofwpdm4W5
UWy6eeiQI2Huq+HuvEYebuz/ZLDsKMq53ZFTfu8GndTQfLcXvu/jk7ACzPgtvyV8
4eIqg9Lnlbs6GDomMmcaLlG2kF1lHCYeFgxJlMCJgpwJAqDetAwB/6q7xFPGhfbt
mLeR7dwCffoVivdBgiFVjlSDL8PJX0fDvsm0uY7gZmGyMzEQUbrBD2s9QIqtDKaK
KamXegbf3pM1EIWdgK9xtbQV2SRYAJmUwaKz6Sfab623jYc=
=pW/X
-----END PGP PUBLIC KEY BLOCK-----
Revocation certificate created.

Please move it to a medium which you can hide away; if Mallory gets
access to this certificate he can use it to make your key unusable.
It is smart to print this certificate and store it away, just in case
your media become unreadable.  But have some caution:  The print system of
your machine might store the data and make it available to others!		
		]]>
		</screen>
	</section>
	<section id="gpg.delete-key">
		<title>åˆ é™¤å¯†é’¥</title>
		<para>é¦–å…ˆï¼Œåˆ é™¤ç§é’¥</para>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --delete-secret-keys E1C21F034FC0ACBF1337EE905E27578A03F0B510
gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.


sec  rsa2048/5E27578A03F0B510 2021-10-08 Netkiller (Test Key) <netkiller@msn.com>

Delete this key from the keyring? (y/N) y
This is a secret key! - really delete? (y/N) y	
		]]>
		</screen>
		<para>ç„¶åï¼Œåˆ é™¤å…¬é’¥</para>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --delete-key E1C21F034FC0ACBF1337EE905E27578A03F0B510
gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.


pub  rsa2048/5E27578A03F0B510 2021-10-08 Netkiller (Test Key) <netkiller@msn.com>

Delete this key from the keyring? (y/N) y		
		]]>
		</screen>
		<para>æœ€åï¼ŒæŸ¥çœ‹å¯†é’¥ï¼Œå¹¶ç¡®è®¤åˆ é™¤</para>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --list-keys
gpg: checking the trustdb
gpg: marginals needed: 3  completes needed: 1  trust model: pgp
gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
gpg: next trustdb check due at 2023-10-08
/root/.gnupg/pubring.kbx
------------------------
pub   rsa2048 2021-10-08 [SC] [expires: 2023-10-08]
      70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6
uid           [ultimate] Neo Chen <netkiller@msn.com>
sub   rsa2048 2021-10-08 [E] [expires: 2023-10-08]			
		]]>
		</screen>
	</section>
	<section id="gpg.import.export">
		<title>å¯†é’¥å€’å…¥/å¯¼å‡º</title>
		<section>
			<title>å¯¼å‡ºå¯†é’¥</title>
			<section>
				<title>å¯¼å‡ºæ‰€æœ‰å…¬é’¥</title>
				<para>--export export keys</para>
				<screen>
				<![CDATA[
[root@netkiller ~]# gpg --export -a
-----BEGIN PGP PUBLIC KEY BLOCK-----

mQENBGFgEfYBCACXIT6K61G3uwwFPxwKaKirZyhSnhh22CwTPEGkeviyXCCfpr2X
d8bjibOCwO8bigXFjaKuTikHmpppy7B/CKJ4OlsLXnoMnnSmynntudJ+jcGmC3/0
QE1nvDzqbe8L5KJ3TMgAuDUSp3QWXqIAXxQfEABLl49wJ11envwTXJVPG/ks2U3m
b/QAFZqd3AxUpEzASIKbtiB5JE/rxnhyZH7fHkt3vU2N3qAcUQ67cJN+thkMEsOo
wnp9eGvDv1qBieQKK5DzxC+a04p4cWv5z0rV4IEE3bRR2wKW45HI9Lmgz8zZyFcO
gTV1HshRYnDBVgzcnyombQfzbd76g5tBQC2vABEBAAG0HE5lbyBDaGVuIDxuZXRr
aWxsZXJAbXNuLmNvbT6JAVQEEwEIAD4WIQRwzs4y5dZ9Erle0efwHAyuqqRY5gUC
YWAR9gIbAwUJA8JnAAULCQgHAgYVCgkICwIEFgIDAQIeAQIXgAAKCRDwHAyuqqRY
5v8UB/9GuKFO86BprJUfPBOE4sqUPH44kLupVMuvM+XaBkuOQIT5q37MPoUpb3Uj
g7tV3Nc+6/VLTCDTERKEfV7PRke2UjjjdYf4EYA2PMVVtHEnWngKhVcMkD2iEvR2
ViCQQ6sCve5lefMQcPyLVMX1ynMOQCNiVcOZjfv+vW2H4BynZC6kG472a3TjoTKz
TlbrsiK/n7CSMLsevQh9UrG2n24rKfxQiWCo9tVxyWjcYLEO6yRzOxC+KnEBVr30
O86qn8A/soKY3PEWWUWCcve9g7Km3OVMQf3kJo+xy3hDafDhuBTvNUH3Bz9lwXa3
Sune2h5J77AbgUCHZSw4MZEWdknxuQENBGFgEfYBCACVjr3QGs1b2cei5sHyBO59
hC8VgehGs42jiItaNQSLpBO8g8Z2UbwcB9y3QWrbBITXfj1Jmy+XJInbc3FYYoZE
9bVHb+KjIR4JLqWrieGCWaKzl78ByRRKfQWO0di5OVMQBWg3yzd2dRJnvpa8+W60
ksHoyL0wcXLDbCxYxTNmpHacbvEJYe4zxYJxMyD3V8BEF/r6HtA8ZrhPHrI23AF6
iqSK7PIKAFBLIbU9jinncy/Vbv1DgXZrh72cxhl0n7hTgX8tI2gFRpz+p10iKX2B
zab3F4Ac1YNBy/F9tqIeCPBGK4CmFTtZkzpokevrIfzLThWuqRGIRtnwqlvMKHxz
ABEBAAGJATwEGAEIACYWIQRwzs4y5dZ9Erle0efwHAyuqqRY5gUCYWAR9gIbDAUJ
A8JnAAAKCRDwHAyuqqRY5hpyB/4hh3qMpSOtjOFS5nWGrYNb/o//YRKDwORjJUdI
t0A1RvQkIZEQ9MYR67xpQ8OO2JrsznB7yF0D/Wrmleuu9lY9IVgdaNdNYRRzAdam
MuU5hYe6cUkNudjekhWb2J77EIaL70g9tboEHlQEdVe/FesLg1iZVlPZaaN6UjN6
81AcVw3nloBgIHQUWWsdsSW5sTfymnMhtUfJVlPfeEagLIioTvTzUqy0LjjeIOhR
B1EXkjs/4g/20c/X9JH8z+QwnZ0lmHy9HzUl+g3zLQ7Vu2xaTwHgBWl5sGdkDkJX
RiSdzxKOlGfxNN0e5r7fUYvlCkqOvAFvdpZANcVYkWurjWt2
=W+8i
-----END PGP PUBLIC KEY BLOCK-----
				]]>
				</screen>
			</section>
			<section>
				<title>å¯¼å‡ºå…¬é’¥åˆ°æŒ‡å®šæ–‡ä»¶</title>
				<para>-o, --output use as output file</para>
				<screen>
				<![CDATA[
$ gpg --export -a -o test.asc
$ gpg --output yourname.asc --export -a
				]]>
				</screen>
				<screen>
				<![CDATA[
[root@netkiller ~]# gpg --list-keys
/root/.gnupg/pubring.kbx
------------------------
pub   rsa2048 2021-10-08 [SC] [expires: 2023-10-08]
      70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6
uid           [ultimate] Neo Chen <netkiller@msn.com>
sub   rsa2048 2021-10-08 [E] [expires: 2023-10-08]

[root@netkiller ~]# gpg --output neo.gpg --export 70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6

[root@netkiller ~]# ls neo.gpg
neo.gpg
				
				]]>
				</screen>
			</section>
			<section>
				<title>å¯¼å‡ºç§é’¥</title>
				<screen>
				<![CDATA[
gpg --armor --output private-key.gpg --export-secret-keys
				]]>
				</screen>
			</section>
		</section>
		<section>
			<title>å¯¼å…¥å¯†é’¥</title>
			<subtitle>--import import/merge keys</subtitle>
			<para>å¯¼å…¥å…¬é’¥</para>
			<screen>
				<![CDATA[
[root@testing ~]# gpg --import /home/www/backup.gpg 
gpg: /root/.gnupg/trustdb.gpg: trustdb created
gpg: key 0C835D03507C8536: public key "Backup <backup@netkiller.cn>" imported
gpg: Total number processed: 1
gpg:               imported: 1				
				]]>
			</screen>
			<para>æŸ¥çœ‹å…¬é’¥</para>
			<screen>
				<![CDATA[
[root@testing ~]# gpg -k
/root/.gnupg/pubring.kbx
------------------------
pub   rsa2048 2021-10-09 [SC] [expires: 2023-10-09]
      18235CBA04497C42EFAC78210C835D03507C8536
uid           [ unknown] Backup <backup@netkiller.cn>
sub   rsa2048 2021-10-09 [E] [expires: 2023-10-09]				
				]]>
			</screen>
			<para></para>
		</section>
		<section>
			<title>å¯†é’¥è¿ç§»</title>
			<para>ä»ä¸€å°æœºå™¨ï¼Œè¿ç§»åˆ°å¦ä¸€å°æœºå™¨</para>
			<para>åŸç”µè„‘</para>
			<screen>
			<![CDATA[
[root@gitlab ~]# gpg --list-keys
/root/.gnupg/pubring.kbx
------------------------
pub   rsa2048 2021-10-08 [SC] [expires: 2023-10-08]
      70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6
uid           [ultimate] Neo Chen <netkiller@msn.com>
sub   rsa2048 2021-10-08 [E] [expires: 2023-10-08]
			
[root@gitlab ~]# gpg --armor --export-secret-keys --output private_key.asc netkiller@msn.com			
[root@gitlab ~]# gpg --armor --export --output public_key.asc netkiller@msn.com
[root@gitlab ~]# scp private_key.asc public_key.asc root@other:/home/gitlab-runner/
			]]>
			</screen>
			<para>ç›®æ ‡ç”µè„‘æˆ–å¦ä¸€ä¸ªè´¦å·</para>
			<screen>
			<![CDATA[
[root@localhost ~]# gpg --import public_key.asc 
gpg: /root/.gnupg/trustdb.gpg: trustdb created
gpg: key F01C0CAEAAA458E6: public key "Neo Chen <netkiller@msn.com>" imported
gpg: Total number processed: 1
gpg:               imported: 1

[root@localhost ~]# gpg --import private_key.asc 
gpg: key F01C0CAEAAA458E6: "Neo Chen <netkiller@msn.com>" not changed
gpg: key F01C0CAEAAA458E6: secret key imported
gpg: Total number processed: 1
gpg:              unchanged: 1
gpg:       secret keys read: 1
gpg:   secret keys imported: 1		

[root@localhost ~]# gpg --list-keys
/root/.gnupg/pubring.kbx
------------------------
pub   rsa2048 2021-10-08 [SC] [expires: 2023-10-08]
      70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6
uid           [ unknown] Neo Chen <netkiller@msn.com>
sub   rsa2048 2021-10-08 [E] [expires: 2023-10-08]

[root@localhost ~]# gpg --list-secret-keys --keyid-format LONG
/root/.gnupg/pubring.kbx
------------------------
sec   rsa2048/F01C0CAEAAA458E6 2021-10-08 [SC] [expires: 2023-10-08]
      70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6
uid                 [ unknown] Neo Chen <netkiller@msn.com>
ssb   rsa2048/EAA2F7FD813D2A2E 2021-10-08 [E] [expires: 2023-10-08]	
			]]>
			</screen>
		</section>
	</section>
	<section id="gpg.sign">
		<title>ç­¾å</title>
		<para>äºŒè¿›åˆ¶æ ¼å¼ *.gpg ç­¾åæ–‡ä»¶</para>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --passphrase "123456" --sign compose.yml		
		]]>
		</screen>
		<para>BASE64 æ ¼å¼çš„ *.asc ç­¾åæ–‡ä»¶</para>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --clear-sign stdin.log 
[root@netkiller ~]# cat stdin.log.asc 
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256


-----BEGIN PGP SIGNATURE-----

iQEzBAEBCAAdFiEEcM7OMuXWfRK5XtHn8BwMrqqkWOYFAmFhDW8ACgkQ8BwMrqqk
WOY//ggAloOa20OfQUrVMKeHNijAhUCvG6wvEAz/cQRMjmkzinsdtVjoDo2gTtiS
lsfB6s4+5PkPq2kCW1v3edWiW33ghb4eK/1GDfTiFvE8ly0goAlD4N5Ruk3ROXJy
9InT5LtsuKTNWO3pKaJTjQ/dVdjcBUdEEZWMxJX5T/+JtJUg1tUOWmG7t+6gon+/
wMAzScqEIa2aaTEyX1tvUVIJWZUakZiqHY2mb3rnKmaUFe7Ny7vbqmkgvkDgzvbV
iIphoFRuTAtu7CbB5BV1oZ0IhiIztH7hlm5M5XlwTPo7fb8hyPo3NkvGsxCEM3mr
H770N2NHUVCumIw1jSOxqIv0cARcyg==
=J8o1
-----END PGP SIGNATURE-----		
		]]>
		</screen>
		<para>ç”Ÿæˆ *.sig æ ¼å¼çš„ç­¾åæ–‡ä»¶</para>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --detach-sign stdin.log

[root@netkiller ~]# ll stdin.log.*
-rw-r--r-- 1 root root 538 Oct  9 11:33 stdin.log.asc
-rw-r--r-- 1 root root 310 Oct  9 11:34 stdin.log.sig		
		]]>
		</screen>
		<para>ç”ŸæˆBASE64 *.sig æ ¼å¼çš„ç­¾åæ–‡ä»¶</para>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --armor --detach-sign stdin.log
File 'stdin.log.asc' exists. Overwrite? (y/N) y
[root@netkiller ~]# cat stdin.log.asc 
-----BEGIN PGP SIGNATURE-----

iQEzBAABCAAdFiEEcM7OMuXWfRK5XtHn8BwMrqqkWOYFAmFhDnkACgkQ8BwMrqqk
WOadjQf7BlOH6iIjylXIN3ziSrwtaM6AgQweBv3+PKV4VCFKLsKJOwecSTzy4sRu
JyzPoPoR/sHbAwe3VqbLTri1HVqtOy5mMuiK9KE3BjbmC8seo97tJ1O4gSd6OjyX
Q3eK/sQfRmo802qAFOj7iKldPGbJyBxhIZ+pirMNbMxrX2tfCq3o7qy1SjAyOhgO
ECorVAcHWl00xBj5vbgJJSIwo1kIx23+e/6lzKEwoseAj0sEPALqmi1r9HzocDoO
B0f5GgJVj74RC6svVQQMDwMjRgf27285CzxLpoTTioURtJawNI2NlUk59U11fYVH
4j8vOaHxTvP17LxAJyA9ndAsxz8y5w==
=+wjo
-----END PGP SIGNATURE-----		
		]]>
		</screen>
	</section>

	<section id="gpg.recipient">
		<title>åŠ å¯†/è§£å¯†æ–‡ä»¶</title>
		<section>
			<title>åŠ å¯†æ–‡ä»¶</title>
			<para>åŠ å¯†</para>
			<screen>
			<![CDATA[
# echo hello > file.txt
# gpg -c file.txt

       lqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqk
       x Enter passphrase                                    x
       x                                                     x
       x                                                     x
       x Passphrase ****____________________________________ x
       x                                                     x
       x       <OK>                             <Cancel>     x
       mqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqj

       lqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqk
       x Please re-enter this passphrase                     x
       x                                                     x
       x Passphrase ****____________________________________ x
       x                                                     x
       x       <OK>                             <Cancel>     x
       mqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqj
       		]]>
			</screen>
			<screen><![CDATA[
# ls file.txt*
file.txt  file.txt.gpg
			]]></screen>

		</section>
		<section>
			<title>è§£å¯†</title>
			<para>è§£å¯†</para>
			<screen>
			<![CDATA[
# gpg -o myfile -d file.txt.gpg

       lqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqk
       x Enter passphrase                                    x
       x                                                     x
       x                                                     x
       x Passphrase ________________________________________ x
       x                                                     x
       x       <OK>                             <Cancel>     x
       mqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqj
       		]]>
			</screen>
		</section>
		<section>
			<title>æŒ‡å®šç”¨æˆ·ID</title>
			<para>-r, --recipient USER-ID encrypt for USER-ID</para>
			<screen>
			<![CDATA[
gpg --recipient [ç”¨æˆ·ID] --output netkiller.epub.gpg --encrypt netkiller.epub			
			]]>
			</screen>
			<screen>
			<![CDATA[
gpg --decrypt netkiller.epub.gpg --output netkiller.epub
			]]>
			</screen>
		</section>
		<section>
			<title>ç­¾å+åŠ å¯†</title>
			<screen>
			<![CDATA[
gpg --local-user [å‘ä¿¡è€…ID] --recipient [æ¥æ”¶è€…ID] --armor --sign --encrypt netkiller.epub			
			]]>
			</screen>
			<para></para>
			<screen>
			<![CDATA[
gpg --verify netkiller.epub.asc netkiller.epub			
			]]>
			</screen>
		</section>
	</section>
	<section id="gpg.edit-key">
		<title>ä¿®æ”¹å¯†é’¥</title>
		<screen>
		<![CDATA[
[root@netkiller ~]# gpg --edit-key 70CECE32E5D67D12B95ED1E7F01C0CAEAAA458E6
gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Secret key is available.

sec  rsa2048/F01C0CAEAAA458E6
     created: 2021-10-08  expires: 2023-10-08  usage: SC  
     trust: ultimate      validity: ultimate
ssb  rsa2048/EAA2F7FD813D2A2E
     created: 2021-10-08  expires: 2023-10-08  usage: E   
[ultimate] (1). Neo Chen <netkiller@msn.com>

gpg> 		
		]]>
		</screen>
		<section>
			<title>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</title>
			<para>ä½¿ç”¨ "?" æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</para>
			<screen>
			<![CDATA[
gpg> ?
quit        quit this menu
save        save and quit
help        show this help
fpr         show key fingerprint
grip        show the keygrip
list        list key and user IDs
uid         select user ID N
key         select subkey N
check       check signatures
sign        sign selected user IDs [* see below for related commands]
lsign       sign selected user IDs locally
tsign       sign selected user IDs with a trust signature
nrsign      sign selected user IDs with a non-revocable signature
adduid      add a user ID
addphoto    add a photo ID
deluid      delete selected user IDs
addkey      add a subkey
addcardkey  add a key to a smartcard
keytocard   move a key to a smartcard
bkuptocard  move a backup key to a smartcard
delkey      delete selected subkeys
addrevoker  add a revocation key
delsig      delete signatures from the selected user IDs
expire      change the expiration date for the key or selected subkeys
primary     flag the selected user ID as primary
pref        list preferences (expert)
showpref    list preferences (verbose)
setpref     set preference list for the selected user IDs
keyserver   set the preferred keyserver URL for the selected user IDs
notation    set a notation for the selected user IDs
passwd      change the passphrase
trust       change the ownertrust
revsig      revoke signatures on the selected user IDs
revuid      revoke selected user IDs
revkey      revoke key or selected subkeys
enable      enable key
disable     disable key
showphoto   show selected photo IDs
clean       compact unusable user IDs and remove unusable signatures from key
minimize    compact unusable user IDs and remove all signatures from key

* The 'sign' command may be prefixed with an 'l' for local signatures (lsign),
  a 't' for trust signatures (tsign), an 'nr' for non-revocable signatures
  (nrsign), or any combination thereof (ltsign, tnrsign, etc.).

			
			]]>
			</screen>
		</section>
		<section>
			<title>ç­¾å</title>
			<screen>
			<![CDATA[
gpg> sign
"Neo Chen <netkiller@msn.com>" was already signed by key F01C0CAEAAA458E6
Nothing to sign with key F01C0CAEAAA458E6

gpg> save			
			]]>
			</screen>
		</section>
		<section>
			<title>å…¬é’¥ä¿¡ä»»é…ç½®</title>
			<para>å½“æˆ‘ä»¬ä½¿ç”¨ GPG åŠ å¯†æ–‡ä»¶çš„æ—¶å€™ä¼šæç¤ºå¦‚ä¸‹ã€‚</para>
			<screen>
			<![CDATA[
gpg: checking the trustdb
gpg: no ultimately trusted keys found
gpg: EAA2F7FD813D2A2E: There is no assurance this key belongs to the named user

sub  rsa2048/EAA2F7FD813D2A2E 2021-10-08 Neo Chen <netkiller@msn.com>
 Primary key fingerprint: 70CE CE32 E5D6 7D12 B95E  D1E7 F01C 0CAE AAA4 58E6
      Subkey fingerprint: CEFB 98EA 8508 45F8 338B  3898 EAA2 F7FD 813D 2A2E

It is NOT certain that the key belongs to the person named
in the user ID.  If you *really* know what you are doing,
you may answer the next question with yes.

Use this key anyway? (y/N) 			
			]]>
			</screen>
			<para>ä¿¡ä»»å…¬é’¥</para>
			<screen>
			<![CDATA[
[gitlab-runner@gitlab ~]$ gpg --edit-key netkiller@msn.com
gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.


pub  rsa2048/F01C0CAEAAA458E6
     created: 2021-10-08  expires: 2023-10-08  usage: SC  
     trust: undefined     validity: unknown
sub  rsa2048/EAA2F7FD813D2A2E
     created: 2021-10-08  expires: 2023-10-08  usage: E   
[ unknown] (1). Neo Chen <netkiller@msn.com>

gpg> trust
pub  rsa2048/F01C0CAEAAA458E6
     created: 2021-10-08  expires: 2023-10-08  usage: SC  
     trust: undefined     validity: unknown
sub  rsa2048/EAA2F7FD813D2A2E
     created: 2021-10-08  expires: 2023-10-08  usage: E   
[ unknown] (1). Neo Chen <netkiller@msn.com>

Please decide how far you trust this user to correctly verify other users' keys
(by looking at passports, checking fingerprints from different sources, etc.)

  1 = I don't know or won't say
  2 = I do NOT trust
  3 = I trust marginally
  4 = I trust fully
  5 = I trust ultimately
  m = back to the main menu

Your decision? 5
Do you really want to set this key to ultimate trust? (y/N) y

pub  rsa2048/F01C0CAEAAA458E6
     created: 2021-10-08  expires: 2023-10-08  usage: SC  
     trust: ultimate      validity: unknown
sub  rsa2048/EAA2F7FD813D2A2E
     created: 2021-10-08  expires: 2023-10-08  usage: E   
[ unknown] (1). Neo Chen <netkiller@msn.com>
Please note that the shown key validity is not necessarily correct
unless you restart the program.

gpg> save
Key not changed so no update needed.			
			]]>
			</screen>
		</section>
	</section>

	<section id="gpg.mysql.backup">
		<title>åŠ å¯†å¤‡ä»½ MySQL</title>
		<para>å‡†å¤‡ç¯å¢ƒï¼š</para>
		<para>æ•°æ®åº“æœåŠ¡å™¨ä¸€å°ï¼Œå¤‡ä»½æœåŠ¡å™¨ä¸€å°ã€‚</para>
		<para>æˆ‘ä»¬å°†åœ¨å¤‡ä»½æœåŠ¡å™¨ä¸Šåˆ›å»ºå¯†é’¥ï¼Œç„¶åå°†å…¬é’¥å¯¼å‡ºå¹¶åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Šå¯¼å…¥ã€‚</para>
		<para>æ•°æ®åº“æœåŠ¡å™¨è¿è¡Œå®šæ—¶å¤‡ä»½è„šæœ¬ï¼ŒåŠ å¯†å¤‡ä»½æ–‡ä»¶ï¼ŒåŒæ—¶æ¯æ—¥å°†åŠ å¯†åçš„å¤‡ä»½æ–‡ä»¶åŒæ­¥åˆ°æœ¬åœ°ã€‚</para>
		<para>å¤‡ä»½å†…å®¹åªèƒ½åœ¨å¤‡ä»½æœåŠ¡å™¨ä¸Šè§£å¯†å’ŒæŸ¥çœ‹</para>
		<section>
			<title>åˆ›å»ºå¯†é’¥å¯¹</title>
			<procedure>
				<title>å¯†é’¥ç®¡ç†</title>
				<step>
					<para>åˆ›å»ºå¯†é’¥</para>
					<screen>
				<![CDATA[
[root@netkiller ~]# gpg --generate-key
gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Note: Use "gpg --full-generate-key" for a full featured key generation dialog.

GnuPG needs to construct a user ID to identify your key.

Real name: Backup
Email address: backup@netkiller.cn
You selected this USER-ID:
    "Backup <backup@netkiller.cn>"

Change (N)ame, (E)mail, or (O)kay/(Q)uit? O				
				]]>
					</screen>
					<para>æ•°æ®å¤‡ä»½ä¸éœ€è¦ Passphrase ç›´æ¥å›è½¦</para>
					<screen>
				<![CDATA[
        â”Œâ”€.....................................................â”
        â”‚ Please enter the passphrase to                       â”‚
        â”‚ protect your new key                                 â”‚
        â”‚                                                      â”‚
        â”‚ Passphrase: ________________________________________ â”‚
        â”‚                                                      â”‚
        â”‚       <OK>                              <Cancel>     â”‚
        â””â”€                                                     â”˜				
				]]>
					</screen>
					<para>é€‰æ‹© â€œYes, protection is not neededâ€ ç›´æ¥å›è½¦ã€‚</para>
					<screen>
				<![CDATA[

                                        â”Œâ”€                                                                                              â”
                                        â”‚ You have not entered a passphrase - this is in general a bad idea!                            â”‚
                                        â”‚ Please confirm that you do not want to have any protection on your key.                       â”‚
                                        â”‚                                                                                               â”‚
                                        â”‚ <Yes, protection is not needed>                                    <Enter new passphrase>     â”‚
                                        â””â”€                                                                                              â”˜				
				]]>
					</screen>
					<para>ç³»ç»Ÿä¼šé‡å¤ä¸Šé¢ğŸ‘†æ­¥éª¤ä¸¤æ¬¡ã€‚ç„¶ååˆ›å»ºå¯†é’¥</para>
					<screen>
				<![CDATA[
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: key 0C835D03507C8536 marked as ultimately trusted
gpg: revocation certificate stored as '/root/.gnupg/openpgp-revocs.d/18235CBA04497C42EFAC78210C835D03507C8536.rev'
public and secret key created and signed.

pub   rsa2048 2021-10-09 [SC] [expires: 2023-10-09]
      18235CBA04497C42EFAC78210C835D03507C8536
uid                      Backup <backup@netkiller.cn>
sub   rsa2048 2021-10-09 [E] [expires: 2023-10-09]				
				]]>
					</screen>
				</step>
				<step>
					<para>å¯¼å‡ºå…¬é’¥</para>
					<para>æŸ¥çœ‹ç”¨æˆ·ID</para>
					<screen>
				<![CDATA[
[root@netkiller ~]# gpg --list-keys backup@netkiller.cn
pub   rsa2048 2021-10-09 [SC] [expires: 2023-10-09]
      18235CBA04497C42EFAC78210C835D03507C8536
uid           [ultimate] Backup <backup@netkiller.cn>
sub   rsa2048 2021-10-09 [E] [expires: 2023-10-09]				
				]]>
					</screen>
					<para>å¯¼å‡º Backup ç”¨æˆ·å…¬é’¥</para>
					<screen>
				<![CDATA[
[root@netkiller ~]# gpg --armor --output backup.gpg --export 18235CBA04497C42EFAC78210C835D03507C8536				
				]]>
					</screen>
					<para>æŠŠå…¬é’¥å‘é€ç»™æ•°æ®åº“æœåŠ¡å™¨</para>
					<screen>
				<![CDATA[
[root@netkiller ~]# scp backup.gpg www@192.168.30.10:/home/www
Warning: Permanently added '192.168.30.10' (ECDSA) to the list of known hosts.
www@192.168.30.10's password: 
backup.gpg				
				]]>
					</screen>
				</step>
			</procedure>
		</section>
		<section>
			<title>æ•°æ®åº“å¤‡ä»½</title>

			<procedure>
				<title>æ•°æ®åº“å¤‡ä»½</title>
				<step>
					<para>å¯¼å…¥å…¬é’¥</para>
					<screen>
				<![CDATA[
[www@testing ~]$ gpg --import backup.gpg 
gpg: directory '/home/www/.gnupg' created
gpg: keybox '/home/www/.gnupg/pubring.kbx' created
gpg: /home/www/.gnupg/trustdb.gpg: trustdb created
gpg: key 0C835D03507C8536: public key "Backup <backup@netkiller.cn>" imported
gpg: Total number processed: 1
gpg:               imported: 1				
				]]>
					</screen>
					<screen>
				<![CDATA[
[www@testing ~]$ gpg -k
/home/www/.gnupg/pubring.kbx
----------------------------
pub   rsa2048 2021-10-09 [SC] [expires: 2023-10-09]
      18235CBA04497C42EFAC78210C835D03507C8536
uid           [ unknown] Backup <backup@netkiller.cn>
sub   rsa2048 2021-10-09 [E] [expires: 2023-10-09]
				]]>
					</screen>
					<para>æµ‹è¯•</para>
					<screen>
				<![CDATA[
[www@testing ~]$ gpg -r 18235CBA04497C42EFAC78210C835D03507C8536 -e netkiller.sql.gz 
gpg: 339634D92F842BE7: There is no assurance this key belongs to the named user

sub  rsa2048/339634D92F842BE7 2021-10-09 Backup <backup@netkiller.cn>
 Primary key fingerprint: 1823 5CBA 0449 7C42 EFAC  7821 0C83 5D03 507C 8536
      Subkey fingerprint: BA6F 7A53 C82B 9945 C1B4  AB09 3396 34D9 2F84 2BE7

It is NOT certain that the key belongs to the person named
in the user ID.  If you *really* know what you are doing,
you may answer the next question with yes.

Use this key anyway? (y/N) y
[www@testing ~]$ ls netkiller.sql.gz*
netkiller.sql.gz  netkiller.sql.gz.gpg				
				]]>
					</screen>
					<para>ä¿¡ä»»å¯†é’¥</para>
					<screen>
				<![CDATA[
[www@testing ~]$ gpg --edit-key 18235CBA04497C42EFAC78210C835D03507C8536
gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.


pub  rsa2048/0C835D03507C8536
     created: 2021-10-09  expires: 2023-10-09  usage: SC  
     trust: unknown       validity: unknown
sub  rsa2048/339634D92F842BE7
     created: 2021-10-09  expires: 2023-10-09  usage: E   
[ unknown] (1). Backup <backup@netkiller.cn>

gpg> trust
pub  rsa2048/0C835D03507C8536
     created: 2021-10-09  expires: 2023-10-09  usage: SC  
     trust: unknown       validity: unknown
sub  rsa2048/339634D92F842BE7
     created: 2021-10-09  expires: 2023-10-09  usage: E   
[ unknown] (1). Backup <backup@netkiller.cn>

Please decide how far you trust this user to correctly verify other users' keys
(by looking at passports, checking fingerprints from different sources, etc.)

  1 = I don't know or won't say
  2 = I do NOT trust
  3 = I trust marginally
  4 = I trust fully
  5 = I trust ultimately
  m = back to the main menu

Your decision? 5
Do you really want to set this key to ultimate trust? (y/N) y

pub  rsa2048/0C835D03507C8536
     created: 2021-10-09  expires: 2023-10-09  usage: SC  
     trust: ultimate      validity: unknown
sub  rsa2048/339634D92F842BE7
     created: 2021-10-09  expires: 2023-10-09  usage: E   
[ unknown] (1). Backup <backup@netkiller.cn>
Please note that the shown key validity is not necessarily correct
unless you restart the program.

gpg> quit				
				]]>
					</screen>
					<para>å†æ¬¡æµ‹è¯•ï¼Œå¯†é’¥å·²ä¿¡ä»»</para>
					<screen>
				<![CDATA[
[www@testing ~]$ rm netkiller.sql.gz.gpg 
[www@testing ~]$ gpg -r 18235CBA04497C42EFAC78210C835D03507C8536 -e netkiller.sql.gz 			
				]]>
					</screen>
				</step>
				<step>
					<para>æ•°æ®åº“å¤‡ä»½</para>
					<para>åœ¨ /etc/cron.daily/ ç›®å½•ä¸‹åˆ›å»º mysql è„šæœ¬ï¼Œç„¶åèµ‹äºˆæ‰§è¡Œæƒé™</para>
					<screen>
				<![CDATA[
root@production:~# cat /etc/cron.daily/mysql 
#!/bin/bash
###################################
# $Id: backup 379 2012-04-02 08:43:42Z netkiller $
# Author: netkiller@msn.com
# Home:	http://netkiller.github.com
###################################
# SELECT `user`, `host`, `password` FROM `mysql`.`user`;
# CREATE USER 'backup'@'localhost' IDENTIFIED BY 'SaJePoM6BAPOmOFOd7Xo3e1A52vEPE';
# GRANT SELECT, LOCK TABLES  ON *.* TO 'backup'@'localhost';
# FLUSH PRIVILEGES;
# SHOW GRANTS FOR 'backup'@'localhost';
###################################
BACKUP_HOST="172.188.122.155"
BACKUP_USER="dba"
BACKUP_PASS=""
BACKUP_DIR=/opt/database/mysql
BACKUP_DBNAME="netkiller neo test"
#TIMEPOINT=$(date -u +%Y-%m-%d)
TIMEPOINT=$(date +%Y-%m-%d.%H:%M:%S)
#Number of copies
COPIES=30
####################################
MYSQLDUMP="/usr/bin/mysqldump"
MYSQLDUMP_OPTS="-h $BACKUP_HOST -u$BACKUP_USER -p$BACKUP_PASS --compress --events --triggers --routines --set-gtid-purged=OFF"
# --skip-lock-tables
####################################
umask 0077
test ! -d "$BACKUP_DIR" && mkdir -p "$BACKUP_DIR"
test ! -w $BACKUP_DIR && echo "Error: $BACKUP_DIR is un-writeable." && exit 0

for dbname in $BACKUP_DBNAME
do
	test ! -d "$BACKUP_DIR/$dbname" && mkdir -p "$BACKUP_DIR/$dbname"
	LOGFILE=$BACKUP_DIR/$dbname/error.log
	$MYSQLDUMP $MYSQLDUMP_OPTS --log-error=$LOGFILE $dbname | gpg -r backup@netkiller.cn -e -o $BACKUP_DIR/$dbname/$dbname.$TIMEPOINT.sql.gpg
done
find $BACKUP_DIR -type f -mtime +$COPIES -delete				
				]]>
					</screen>
					<tip>gpg è‡ªå¸¦å‹ç¼©ï¼Œæ‰€ä»¥å¤‡ä»½æ•°æ®æ— éœ€ä½¿ç”¨ gzip å‹ç¼©</tip>
					<screen>
				<![CDATA[
[www@testing ~]$ gpg -r backup@netkiller.cn -e netkiller.2021-8-28.sql
[www@testing ~]$ ll
-rw-r--r-- 1 www www 588143144 2021-08-28 10:31 netkiller.2021-8-28.sql
-rw-r--r-- 1 www www  41395738 2021-10-09 12:01 netkiller.2021-8-28.sql.gpg				
				]]>
					</screen>
					<para>æºæ–‡ä»¶å¤§å°æ˜¯ 588143144ï¼Œç»è¿‡ gpg å‹ç¼©å 41395738</para>
					<para>ä½¿ç”¨ -z å‚æ•°å¯ä»¥è®¾ç½®å‹ç¼©çº§åˆ«ï¼Œè¿™é‡Œè®¾ç½®ä¸ºæœ€é«˜çº§åˆ«9ï¼Œå‹ç¼©åå¤§å°æ˜¯ 39847904ï¼Œä½†æ˜¯é€šå¸¸æˆ‘ä¸å»ºè®®è®¾ç½®ï¼Œè¿™ä¼šå½±å“æ•°æ®è¢«å¤‡ä»½æ—¶å¸¸ï¼Œæ•°æ®å¤‡ä»½è¿‡ç¨‹éœ€è¦é”è¡¨ï¼Œä¼šå½±å“ç”¨æˆ·è®¿é—®ï¼Œæ‰€ä»¥è¦å°½å¿«å®Œæˆå¤‡ä»½ã€‚</para>
					<screen>
				<![CDATA[
[www@testing ~]$ gpg -r backup@netkiller.cn -z 9 -e netkiller.2021-8-28.sql
File 'netkiller.2021-8-28.sql.gpg' exists. Overwrite? (y/N) y

[www@testing ~]$ ll netkiller.2021-8-28.sql*
-rw-r--r-- 1 www www 588143144 2021-08-28 10:31 netkiller.2021-8-28.sql
-rw-r--r-- 1 www www  39847904 2021-10-09 12:17 netkiller.2021-8-28.sql.gpg				
				]]>
					</screen>
				</step>
			</procedure>
		</section>
		<section>
			<title>æ•°æ®åº“è¿˜åŸ</title>

			<procedure>
				<title>æ•°æ®åº“è¿˜åŸ</title>
				<step>
					<para>å®šæ—¶åŒæ­¥</para>
					<screen>
				<![CDATA[
[root@netkiller ~]# cat /etc/cron.daily/mysql 
rsync -auzv www@db.netkiller.cn:/opt/database/mysql /opt/backup/database/				
				]]>
					</screen>
				</step>
				<step>
					<para>è§£å¯†æ•°æ®åº“å¤‡ä»½æ–‡ä»¶</para>
					<screen>
				<![CDATA[
[root@netkiller ~]# gpg netkiller.2021-8-28.sql.gpg				
				]]>
					</screen>
					<para>--output æŒ‡å®šæ–‡ä»¶å</para>
					<screen>
				<![CDATA[
[root@netkiller ~]# gpg --output netkiller.2021-8-28.sql --decrypt netkiller.2021-8-28.sql.gpg
gpg: encrypted with 2048-bit RSA key, ID 339634D92F842BE7, created 2021-10-09
      "Backup <backup@netkiller.cn>"
				]]>
					</screen>
					<para>ç›´æ¥æ¢å¤æ•°æ®åº“</para>
					<screen>
				<![CDATA[
[root@netkiller ~]# gpg --decrypt netkiller.2021-8-28.sql.gpg | mysql netkiller				
				]]>
					</screen>
				</step>
			</procedure>
		</section>
	</section>
	<section>
		<title>FAQ</title>
		<section>
			<title>æŒ‡å®š passphrase</title>
			<screen>
			<![CDATA[
gpg --batch --passphrase "chen" --sign compose.yml			
			]]>
			</screen>
		</section>

		<section id="gpg.old">
			<title>æ—§ç‰ˆæœ¬ 1.4.11</title>
			<section id="gpg.conf">
				<title>GnuPG</title>
				<para>GnuPG</para>
				<screen><![CDATA[
~/.gnupg/gpg.conf 	 â€“ é…ç½®æ–‡ä»¶
~/.gnupg/trustdb.gpg â€“ ä¿¡ä»»åº“
~/.gnupg/pubring.gpg â€“ å…¬é’¥åº“
~/.gnupg/secring.gpg â€“ ç§é’¥åº“
		]]></screen>
			</section>
			<section>
				<title>Creating a key (åˆ›å»ºkey) </title>
				<subtitle>--gen-key generate a new key pair</subtitle>
				<screen>
			<![CDATA[
neo@neo-laptop:~$ gpg --gen-key
gpg (GnuPG) 1.4.11; Copyright (C) 2010 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection?
RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (2048)
Requested keysize is 2048 bits
Please specify how long the key should be valid.
         0 = key does not expire
      <n>  = key expires in n days
      <n>w = key expires in n weeks
      <n>m = key expires in n months
      <n>y = key expires in n years
Key is valid for? (0) 1y
Key expires at Tuesday, October 22, 2013 PM03:25:35 HKT
Is this correct? (y/N) y

You need a user ID to identify your key; the software constructs the user ID
from the Real Name, Comment and Email Address in this form:
    "Heinrich Heine (Der Dichter) <heinrichh@duesseldorf.de>"

Real name: Neo Chan
Email address: netkiller@msn.com
Comment: Office Email
You selected this USER-ID:
    "Neo Chan (Office Email) <netkiller@msn.com>"

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
You need a Passphrase to protect your secret key.

We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.

Not enough random bytes available.  Please do some other work to give
the OS a chance to collect more entropy! (Need 282 more bytes)
.......+++++
.......+++++
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
..+++++
..+++++
gpg: key CEF09301 marked as ultimately trusted
public and secret key created and signed.

gpg: checking the trustdb
gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
gpg: next trustdb check due at 2013-10-22
pub   2048R/CEF09301 2012-10-22 [expires: 2013-10-22]
      Key fingerprint = C5B7 50EF 762F 3F7F 1AE5  8AEC AF10 D50D CEF0 9301
uid                  Neo Chan (Office Email) <netkiller@msn.com>
sub   2048R/0BF4D523 2012-10-22 [expires: 2013-10-22]
			]]>
				</screen>
			</section>
			<section>
				<title>--list-keys åˆ—å‡ºå·²å­˜åœ¨çš„è¯ä¹¦</title>
				<screen>
			<![CDATA[
$ gpg --list-keys
/home/neo/.gnupg/pubring.gpg
----------------------------
pub   1024R/63268A35 2013-09-11
uid                  Neo Chen (netkiller) <netkiller@msn.com>
sub   1024R/F4F946F9 2013-09-11
			]]>
				</screen>
			</section>

			<section>
				<title>Exporting keys (å¯¼å‡ºkey)</title>
				<section>
					<title>--export export keys</title>
					<para></para>
					<screen>
				<![CDATA[
gpg --export -a
				]]>
					</screen>
				</section>
				<section>
					<title>-o, --output use as output file</title>
					<screen>
				<![CDATA[
$ gpg --export -a -o test.asc
$ gpg --output yourname.asc --export -a
				]]>
					</screen>
				</section>
			</section>
			<section>
				<title>Importing keys (å¯¼å…¥key)</title>
				<subtitle>--import import/merge keys</subtitle>
				<para></para>
				<screen>
			<![CDATA[
neo@neo-laptop:~$ gpg --import 409.asc
gpg: key 4D3A0803: public key "Phoenix.L <409@example.com>" imported
gpg: key CEF09301: "Neo Chan (Office Email) <netkiller@msn.com>" not changed
gpg: Total number processed: 2
gpg:               imported: 1  (RSA: 1)
gpg:              unchanged: 1

			]]>
				</screen>
			</section>

			<section>
				<title>Revoke a key (åŠé”€key)</title>
				<screen>
			<![CDATA[
gpg --gen-revoke
			]]>
				</screen>
			</section>
		</section>

	</section>

	<section id="GnuPG4Windows">
		<title>GnuPG For Windows</title>
		<para>ä¸‹è½½OpenGPG: http://www.gnupg.org/</para>
		<note>
			<para>GnuPG (OpenGPG)å®‰è£…æ—¶å¯ä»¥é€‰æ‹©è¯­è¨€ï¼Œæ”¯æŒç®€ä½“ä¸­æ–‡ï¼ä½†å¯¹ä¸­æ–‡æ”¯æŒä¸æ˜¯å¾ˆå¥½ï¼Œå¦‚çœŸå®å§“åè¾“å…¥ï¼šç‹è€äº”,ç³»ç»Ÿæç¤º"å§“åè‡³å°‘è¦æœ‰äº”ä¸ªå­—ç¬¦é•¿"</para>
		</note>

		<section>
			<title>ç”Ÿæˆå¯†é’¥å¯¹</title>
			<para>ä½¿ç”¨ gpg --gen-key ç”Ÿæˆå¯†é’¥å¯¹</para>
			<screen>
			<![CDATA[
C:\GNU>gpg --gen-key
gpg (GnuPG) 1.4.3; Copyright (C) 2006 Free Software Foundation, Inc.
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions. See the file COPYING for details.

è¯·é€‰æ‹©æ‚¨è¦ä½¿ç”¨çš„å¯†é’¥ç§ç±»ï¼š
   (1) DSA å’Œ ElGamal (é»˜è®¤)
   (2) DSA (ä»…ç”¨äºç­¾å­—)
   (5) RSA (ä»…ç”¨äºç­¾å­—)
æ‚¨çš„é€‰æ‹©ï¼Ÿ
DSA å¯†é’¥å¯¹ä¼šæœ‰ 1024 ä½ã€‚
ELG-E å¯†é’¥é•¿åº¦åº”åœ¨ 1024 ä½ä¸ 4096 ä½ä¹‹é—´ã€‚
æ‚¨æƒ³è¦ç”¨å¤šå¤§çš„å¯†é’¥å°ºå¯¸ï¼Ÿ(2048)
æ‚¨æ‰€è¦æ±‚çš„å¯†é’¥å°ºå¯¸æ˜¯ 2048 ä½
è¯·è®¾å®šè¿™æŠŠå¯†é’¥çš„æœ‰æ•ˆæœŸé™ã€‚
         0 = å¯†é’¥æ°¸ä¸è¿‡æœŸ
      <n>  = å¯†é’¥åœ¨ n å¤©åè¿‡æœŸ
      <n>w = å¯†é’¥åœ¨ n å‘¨åè¿‡æœŸ
      <n>m = å¯†é’¥åœ¨ n æœˆåè¿‡æœŸ
      <n>y = å¯†é’¥åœ¨ n å¹´åè¿‡æœŸ
å¯†é’¥çš„æœ‰æ•ˆæœŸé™æ˜¯ï¼Ÿ(0)
å¯†é’¥æ°¸è¿œä¸ä¼šè¿‡æœŸ
ä»¥ä¸Šæ­£ç¡®å—ï¼Ÿ(y/n)y

æ‚¨éœ€è¦ä¸€ä¸ªç”¨æˆ·æ ‡è¯†æ¥è¾¨è¯†æ‚¨çš„å¯†é’¥ï¼›æœ¬è½¯ä»¶ä¼šç”¨çœŸå®å§“åã€æ³¨é‡Šå’Œç”µå­é‚®ä»¶åœ°å€ç»„åˆ
æˆç”¨æˆ·æ ‡è¯†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
    â€œHeinrich Heine (Der Dichter) <heinrichh@duesseldorf.de>â€

çœŸå®å§“åï¼šneo chen
ç”µå­é‚®ä»¶åœ°å€ï¼šopenunix@163.com
æ³¨é‡Šï¼šnetkiller
æ‚¨é€‰å®šäº†è¿™ä¸ªç”¨æˆ·æ ‡è¯†ï¼š
    â€œneo chen (netkiller) <openunix@163.com>â€

æ›´æ”¹å§“å(N)ã€æ³¨é‡Š(C)ã€ç”µå­é‚®ä»¶åœ°å€(E)æˆ–ç¡®å®š(O)/é€€å‡º(Q)ï¼ŸO
æ‚¨éœ€è¦ä¸€ä¸ªå¯†ç æ¥ä¿æŠ¤æ‚¨çš„ç§é’¥ã€‚

æˆ‘ä»¬éœ€è¦ç”Ÿæˆå¤§é‡çš„éšæœºå­—èŠ‚ã€‚è¿™ä¸ªæ—¶å€™æ‚¨å¯ä»¥å¤šåšäº›çäº‹(åƒæ˜¯æ•²æ‰“é”®ç›˜ã€ç§»åŠ¨
é¼ æ ‡ã€è¯»å†™ç¡¬ç›˜ä¹‹ç±»çš„)ï¼Œè¿™ä¼šè®©éšæœºæ•°å­—å‘ç”Ÿå™¨æœ‰æ›´å¥½çš„æœºä¼šè·å¾—è¶³å¤Ÿçš„ç†µæ•°ã€‚
+++++++++++++++++++++++++++++++++++.+++++++++++++++++++++++++++++++++++.++++++++
++++++++++++.++++++++++++++++++++.+++++++++++++++++++++++++...>+++++............
..+++++
æˆ‘ä»¬éœ€è¦ç”Ÿæˆå¤§é‡çš„éšæœºå­—èŠ‚ã€‚è¿™ä¸ªæ—¶å€™æ‚¨å¯ä»¥å¤šåšäº›çäº‹(åƒæ˜¯æ•²æ‰“é”®ç›˜ã€ç§»åŠ¨
é¼ æ ‡ã€è¯»å†™ç¡¬ç›˜ä¹‹ç±»çš„)ï¼Œè¿™ä¼šè®©éšæœºæ•°å­—å‘ç”Ÿå™¨æœ‰æ›´å¥½çš„æœºä¼šè·å¾—è¶³å¤Ÿçš„ç†µæ•°ã€‚
+++++.++++++++++++++++++++..++++++++++.+++++.++++++++++.++++++++++.+++++.+++++++
++++++++.+++++....+++++..++++++++++.++++++++++++++++++++..++++++++++++++++++++.+
++++>++++++++++...>.+++++.............................>+++++<+++++..............
..............+++++^^^^^
gpg: å¯†é’¥ C9441A1A è¢«æ ‡è®°ä¸ºç»å¯¹ä¿¡ä»»
å…¬é’¥å’Œç§é’¥å·²ç»ç”Ÿæˆå¹¶ç»ç­¾å­—ã€‚

gpg: æ­£åœ¨æ£€æŸ¥ä¿¡ä»»åº¦æ•°æ®åº“
gpg: éœ€è¦ 3 ä»½å‹‰å¼ºä¿¡ä»»å’Œ 1 ä»½å®Œå…¨ä¿¡ä»»ï¼ŒPGP ä¿¡ä»»æ¨¡å‹
gpg: æ·±åº¦ï¼š0 æœ‰æ•ˆæ€§ï¼š  2 å·²ç­¾å­—ï¼š  0 ä¿¡ä»»åº¦ï¼š0-ï¼Œ0qï¼Œ0nï¼Œ0mï¼Œ0fï¼Œ2u
pub   1024D/C9441A1A 2006-06-02
å¯†é’¥æŒ‡çº¹ = EFDC A97C C711 E9C9 FAC1  3EA9 33C1 1FB2 C944 1A1A
uid                  neo chen (netkiller) <openunix@163.com>
sub   2048g/B713326C 2006-06-02

C:\GNU>
			]]>
			</screen>

		</section>
		<section>
			<title>åˆ—å‡ºå¯†é’¥</title>
			<para>åˆ—å‡ºå¯†é’¥ä½¿ç”¨ gpg --list-keys</para>
			<screen>
<![CDATA[
C:\GNU>gpg --list-keys
C:/Documents and Settings/neo.chen/Application Data/gnupg\pubring.gpg
---------------------------------------------------------------------
pub   1024D/C9441A1A 2006-06-02
uid                  neo chen (netkiller) <openunix@163.com>
sub   2048g/B713326C 2006-06-02
]]>
			</screen>
			<para>åˆ—å‡ºå¯†é’¥å’Œç­¾å­—ä½¿ç”¨ gpg --list-keys</para>
			<screen>
<![CDATA[
C:\GNU>gpg --list-sigs
C:/Documents and Settings/neo.chen/Application Data/gnupg\pubring.gpg
---------------------------------------------------------------------
pub   1024D/C9441A1A 2006-06-02
uid                  neo chen (netkiller) <openunix@163.com>
sig 3        C9441A1A 2006-06-02  neo chen (netkiller) <openunix@163.com>
sub   2048g/B713326C 2006-06-02
sig          C9441A1A 2006-06-02  neo chen (netkiller) <openunix@163.com>
]]>
			</screen>
			<para>åˆ—å‡ºå¹¶æ£€æŸ¥å¯†é’¥ç­¾å­— gpg --check-sigs</para>
			<screen>
<![CDATA[
C:\GNU>gpg --check-sigs
C:/Documents and Settings/neo.chen/Application Data/gnupg\pubring.gpg
---------------------------------------------------------------------
pub   1024D/C9441A1A 2006-06-02
uid                  neo chen (netkiller) <openunix@163.com>
sig!3        C9441A1A 2006-06-02  neo chen (netkiller) <openunix@163.com>
sub   2048g/B713326C 2006-06-02
sig!         C9441A1A 2006-06-02  neo chen (netkiller) <openunix@163.com>
]]>
			</screen>
		</section>
		<section>
			<title>éªŒè¯ç­¾å­—</title>
			<para>
				æ£€æŸ¥ PGP ç­¾å ä¸
				<link linkend="md5sum">md5sum</link>
				ä½œç”¨ç±»ä¼¼:
			</para>
			<screen><![CDATA[
bash$ gpg --verify gnupg-x.x.x.tar.gz.sig gnupg-x.x.x.tar.gz
bash$ md5sum gnupg-x.x.x.tar.gz
			]]></screen>

		</section>
		<section id="gpg4win">
			<title>EMail-Security</title>
			<para>EMail-Security using GnuPG for Windows</para>
			<para>
				<ulink url='http://www.gpg4win.org/'>gpg4win</ulink>
			</para>
		</section>
	</section>

	<section id="smartcard">
		<title>Smart Card</title>
		<para>http://www.gnupg.org/howtos/card-howto/en/smartcard-howto-single.html</para>

	</section>

	<section id="PGP">
		<title>PGP</title>
		<para>ä¸‹è½½PGP: http://www.pgp.com/</para>
	</section>
	<section id="OpenPGP/">
		<title>OpenPGP</title>
		<para>
			<ulink url="https://www.openpgp.org" />
		</para>
		<para>ä¸‹è½½OpenPGP: http://www.pgpi.org/</para>
	</section>
</chapter>
